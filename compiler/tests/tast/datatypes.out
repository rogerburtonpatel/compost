(datatype intlist ([cons-int (int intlist)] [nil-intlist ()]))
(datatype direction ([left ()] [right ()] [up ()] [down ()]))
(datatype bst ([buildbst (int bst bst)] [nil-bst ()]))
(datatype multilist ([cons-multi-int (int multilist)] [cons-multi-bool (bool multilist)] [nil-multilist ()]))
(datatype twointlist ([build (intlist intlist)]))
(: print-endline (-> () unit))
(define print-endline () (@print-sym '
'))
(: main (-> () unit))
(define main () (let ([5 (@test-intlist )]) (let ([4 (@test-direction )]) (let ([3 (@test-bst )]) (let ([2 (@test-multilist )]) (@test-twointlist ))))))
(: test-intlist (-> () unit))
(define test-intlist () (let ([9 (@print-sym 'Starting intlist test')]) (let ([8 (@print-endline )]) (let ([7 (let ([intlistinst (@init-intlist )]) (let ([intlistinst2 (dup intlistinst)]) (@print-intlist %intlistinst2)))]) (let ([6 (@print-sym 'Finished intlist test')]) (@print-endline ))))))
(: init-intlist (-> () intlist))
(define init-intlist () (@cons-int 0 (@cons-int 1 (@cons-int 2 (@nil-intlist )))))
(: print-intlist (-> (intlist) unit))
(define print-intlist (listinst) (case %listinst ([(cons-int x xs) (let ([10 (@print-int %x)]) (@print-intlist %xs))] [(nil-intlist ) (@print-endline )])))
(: test-direction (-> () unit))
(define test-direction () (let ([16 (@print-sym 'Starting direction test')]) (let ([15 (@print-endline )]) (let ([14 (let ([leftdir (@left )]) (let ([rightdir (@right )]) (let ([leftdir2 (dup leftdir)]) (let ([13 (@print-dir %leftdir2)]) (let ([12 (@print-dir %rightdir)]) (@print-endline ))))))]) (let ([11 (@print-sym 'Finished direction test')]) (@print-endline ))))))
(: print-dir (-> (direction) unit))
(define print-dir (dirinst) (let ([17 (case %dirinst ([(left ) (@print-sym 'Left')] [(right ) (@print-sym 'Right')] [(up ) (@print-sym 'Up')] [(down ) (@print-sym 'Down')]))]) (@print-endline )))
(: test-bst (-> () unit))
(define test-bst () (let ([22 (@print-sym 'Starting bst test')]) (let ([21 (@print-endline )]) (let ([20 (let ([bst1 (@init-bst )]) (let ([bst2 (dup bst1)]) (@in-order-print %bst2)))]) (let ([19 (@print-endline )]) (let ([18 (@print-sym 'Finishing bst test')]) (@print-endline )))))))
(: init-bst (-> () bst))
(define init-bst () (let ([leaf1 (@buildbst 0 (@nil-bst ) (@nil-bst ))]) (let ([leaf2 (@buildbst 2 (@nil-bst ) (@nil-bst ))]) (let ([leaf3 (@buildbst 4 (@nil-bst ) (@nil-bst ))]) (let ([subtree1 (@buildbst 1 %leaf1 %leaf2)]) (let ([subtree2 (@buildbst 5 %leaf3 (@nil-bst ))]) (let ([root (@buildbst 3 %subtree1 %subtree2)]) %root)))))))
(: in-order-print (-> (bst) unit))
(define in-order-print (root) (case %root ([(nil-bst ) unit] [(buildbst num left-subtree right-subtree) (let ([24 (@in-order-print %left-subtree)]) (let ([23 (@print-int %num)]) (@in-order-print %right-subtree)))])))
(: test-multilist (-> () unit))
(define test-multilist () (let ([29 (@print-sym 'Starting multilist test')]) (let ([28 (@print-endline )]) (let ([27 (let ([multilistinst (@init-multilist )]) (let ([multilistinst2 (dup multilistinst)]) (let ([26 (@print-multilist %multilistinst2)]) (@print-multilist-ints %multilistinst2))))]) (let ([25 (@print-sym 'Finished intlist test')]) (@print-endline ))))))
(: init-multilist (-> () multilist))
(define init-multilist () (@cons-multi-int 1 (@cons-multi-bool true (@cons-multi-int 2 (@cons-multi-bool false (@nil-multilist ))))))
(: print-multilist (-> (multilist) unit))
(define print-multilist (inst) (case %inst ([(cons-multi-int x xs) (let ([33 (@print-int %x)]) (let ([32 (@print-endline )]) (@print-multilist %xs)))] [(cons-multi-bool x xs) (let ([31 (@print-bool %x)]) (let ([30 (@print-endline )]) (@print-multilist %xs)))] [(nil-multilist ) unit])))
(: print-multilist-ints (-> (multilist) unit))
(define print-multilist-ints (inst) (case %inst ([(cons-multi-int x xs) (let ([35 (@print-int %x)]) (let ([34 (@print-endline )]) (@print-multilist-ints %xs)))] [(cons-multi-bool _ xs) (@print-multilist-ints %xs)] [_ unit])))
(: test-twointlist (-> () unit))
(define test-twointlist () (let ([39 (@print-sym 'Starting twointlist test')]) (let ([38 (@print-endline )]) (let ([37 (let ([inst1 (@init-intlist )]) (let ([inst2tmp (@init-intlist )]) (let ([inst2 (@cons-int -1 %inst2tmp)]) (let ([inst (@build %inst1 %inst2)]) (@print-twointlist %inst)))))]) (let ([36 (@print-sym 'Finishing twointlist test')]) (@print-endline ))))))
(: print-twointlist (-> (twointlist) unit))
(define print-twointlist (inst) (case %inst ([(build l1 l2) (let ([44 (@print-sym 'List 1:')]) (let ([43 (@print-endline )]) (let ([42 (@print-intlist %l1)]) (let ([41 (@print-sym 'List 2:')]) (let ([40 (@print-endline )]) (@print-intlist %l2))))))])))